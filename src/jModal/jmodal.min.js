!function(jEli,_){function jTheatreDirectiveFn(a,b){function c(b,c,d){a.modalObjects.Tbody=_("<div></div>").attr("id","projata-Tbody").addClass("clearfix"),a.modalObjects.Twrap=_("<div></div>").attr("id","projata-theatre"),a.modalObjects.TButtonWrapper=_('<div id="projata-theatre-button"></div>'),a.modalObjects.TBottomC=_('<div id="projata-BottomContainer"></div>').append(a.modalObjects.TButtonWrapper),a.modalObjects.TMenu=_('<ul id="projata-Menu" theatre-menu-board><li id="pTMenu" j-for="menu in theatreMenu"><a  title="{%menu.title%}"  j-click="$performMenuTask(menu.taskName)" role="button" >{%menu.title%}</a></li></ul>'),a.modalObjects.Tbutton=_('<a href="javascript:;" title="More Options" j-click="theatre.slideMenu($event)"> Options </a>'),a.modalObjects.TButtonWrapper.append(a.modalObjects.TMenu,a.modalObjects.Tbutton),a.modalObjects.Tclose=_("<a id='projata-theatre-close' title='Close view' j-click='theatre.closeTheatre()'></a>").addClass("fa fa-times fa-2x"),a.modalObjects.Timg=_('<div id="projata-theatre-img"></div>'),a.modalObjects.Tcomment=_('<div id="projata-theatre-comment" class="" theatre-comment-main-board></div>'),a.modalObjects.TCDetails=_('<div id="projata-TCDetails" theatre-details-board></div>'),a.modalObjects.TCBoard=_('<div id="projata-TCBoard" theatre-comment-board></div>'),a.modalObjects.TCWriteBoard=_('<div id="projata-TCWriteBoard" theatre-write-board></div>'),a.modalObjects.Tbody.append(a.modalObjects.Tclose,a.modalObjects.Timg,a.modalObjects.Tcomment.append(a.modalObjects.TCDetails,a.modalObjects.TCBoard,a.modalObjects.TCWriteBoard)),a.modalObjects.Timg.append(a.modalObjects.TCimg=_('<div id="projata-TCimg"></div>'),a.modalObjects.Thover=_('<div id="projata-hoverNav"></div>').append(a.modalObjects.Tright=_('<a href="javascript:;" id="projata-left" j-click="theatre.end()"><span class="fancy-ico" id="projata-left-ico"></span></a>'),a.modalObjects.Tleft=_('<a href="javascript:;" id="projata-right" j-click="theatre.showNext()"><span class="fancy-ico" id="projata-right-ico"></span></a>')),a.modalObjects.TImageData=_('<div id="projata-ImageData"></div>').append(a.modalObjects.TNumDisplay=_('<div id="projata-NumDisplay"></div>'),a.modalObjects.TDetailsNav=_('<div id="projata-DetailsNav" class="border"></div>')),a.modalObjects.TLightImage=_('<img id="projata-TBoxImage">')),a.modalObjects.Twrap.append(a.modalObjects.Tbody,a.modalObjects.TBottomC),a.modalObjects.TDetailsNav.click(function(){}),d.theatre=a.theatre,d.theatre.slideMenu=function(b){a.modalObjects.TMenu.slideToggle("slow",function(){_(this).click(function(){_(this).fadeOut()})})},a.$on("$extend.model",function(a,b){if(b&&jEli.$isObject(b))for(var c in b)d[c]=b[c]}),b.append(a.modalObjects.Twrap),a.reformatContainer()}return{$init:c}}function jModalDirectiveFn(a,b){return{allowType:"AE",$init:function(b,c,d){a.modalObjects.wrap=_("<div></div>").attr("id","projata-wrap"),a.modalObjects.content=_("<div></div>").addClass("ui-corner-all").attr("id","projata-content"),a.modalObjects.overlay=_("<div></div>").attr("id","projata-overlay"),a.modalObjects._temp=_("<div></div>").attr("id","projata-temp"),a.modalObjects.title=_("<div></div>").addClass("ui-dialog-titlebar ui-widget-header ui-helper-clearfix"),a.modalObjects.titleBar=_("<span></span>").addClass("ui-dialog-title").appendTo(a.modalObjects.title),a.modalObjects.close=_('<a j-click="$closeModal()"></a>').addClass("ui-dialog-titlebar-close ui-corner-all fa fa-times fa-lg").attr("role","button").attr("id","pojata-close").appendTo(a.modalObjects.titleBar),a.modalObjects.outter=_("<div></div>").attr({id:"projata-outter"}).appendTo(a.modalObjects.wrap),a.modalObjects.outter.append(a.modalObjects.content),d.$closeModal=a.$closejata,b.append(a.modalObjects.wrap,a.modalObjects.overlay,a.modalObjects._temp)}}}function jLoadingDirectiveFn(a,b){function c(b,c,d){a.modalObjects.loading=_(b.getFirstChild())}return{template:"<div j-click='$closeModal()' id='projata-loading'><div></div></div>",$init:c}}function jModalUiFn(){return{template:function(a,b){return"<j-modal></j-modal><j-theatre></j-theatre><j-loading></j-loading>"}}}function jTabPreviewDirectiveFn(a,b){return{template:"<div id='jTabHolder' class='tabShade'><span class='fa fa-caret-{%arrow%} fa-2x tabArrow_{%arrow%}'></span><div id='tabBox'><div j-include='url'></div> <div j-html='content'></div></div></div>"}}function bnModalFactoryFN($document,$window,$http){function abortjata(){modalObject.loading.hide(),ajaxLoader&&ajaxLoader.abort(),modalObject._temp.empty()}function errorjata(){selectedOpts.width="auto",selectedOpts.height="auto",modalObject._temp.html('<p id="projata-error">The requested content cannot be loaded.<br />Please try again later.</p>'),processInline()}function $on(a,b){_events[a]=b}function buildEvent(a){return{type:a,timeStamp:+new Date,preventDefault:function(){},currentTarget:function(){return null}}}function $broadcast(a,b){a&&_events[a]&&_events[a].apply(modalObject,[buildEvent(a),b])}function modalIntializer(a){var b,c,d,e={Td:null,prefix:"",title:"",width:560,height:340,content:"",onAjaxContentLoaded:null,cH:$document.height(),cW:$window.width(),wH:$window.height(),dW:$document.width(),onWindowClose:null,closeButton:!0,transitionIn:"fade",transitionOut:"fade",overlayDuration:.4,overlayOpacity:.7,scrolling:"auto",startZoom:!1,animate:!0,padding:10,showGroupName:!1,margin:40,borderSize:21,breathingSize:20,modal:!1,theatre:!1,featBrowser:!0,floating:!0,googleAnalytics:!1,speedIn:"300",speedOut:"300",enableEscapebutton:!0,enableNav:!0,resizeSpeed:7,autoDimensions:!0,autoScale:!0,buttons:{},ajax:{},hideOnOverlayclick:!0,showOverlay:!1,centerOnScroll:!1,containerId:document,classname:"TLightBox",strings:{closeLink:"",loadingMsg:"loading",nextLink:"",prevLink:"",startSlideshow:"",stopSlideshow:"",numDisplayPrefix:"",numDisplaySeparator:"/"},onStart:function(){},onCancel:function(){},onComplete:function(){},onClosed:function(){},onError:function(){}},f=(selectedArray[selectedIndex],new Date);f.getTime();if(abortjata(),selectedOpts=_.extend({},e,a),classNames=selectedOpts.classname,container=selectedOpts.containerId,selectedOpts.animate?(overlayDuration=Math.max(selectedOpts.overlayDuration,0),selectedOpts.resizeSpeed=Math.max(Math.min(selectedOpts.resizeSpeed,10),1),resizeDuration=.15*(11-selectedOpts.resizeSpeed)):(overlayDuration=0,resizeDuration=0),selectedOpts.href&&(b=selectedOpts.href),selectedOpts.content&&(c="normal"),selectedOpts.tab&&(c="tabPreview"),selectedOpts.theatre&&selectedOpts.Td?c="theatre":selectedOpts.href&&(c="ajax"),!c)return void errorjata();switch(selectedOpts.href=b,selectedOpts.type=c,selectedOpts.modal&&(selectedOpts.hideOnOverlayclick=!1,selectedOpts.showOverlay=!0),selectedOpts.autoDimensions&&("normal"==selectedOpts.type||"ajax"==selectedOpts.type?(selectedOpts.width="auto",selectedOpts.height="auto"):selectedOpts.autoDimensions=!1),selectedOpts.padding=parseInt(selectedOpts.padding,10),selectedOpts.margin=parseInt(selectedOpts.margin,10),modalObject._temp.css("padding",selectedOpts.padding+selectedOpts.margin),c){case"normal":modalObject._temp.html(selectedOpts.content),processInline();break;case"ajax":netbuzz=!1,netLoading(),ajaxLoader=_.ajax(_.extend({},selectedOpts.ajax,{url:selectedOpts.href,data:selectedOpts.data||{},error:function(a,b,c){a.status>0&&errorjata()},success:function(a,b,c){var e="object"==typeof c?c:ajaxLoader;if(200==e.status){if(a===!1)return void loading.hide();d=a,(jEli.$isObject(a)||jEli.$isJsonString(a))&&(d=processResponseContent(a),a=d.message||""),selectedOpts.onSuccess&&selectedOpts.onSuccess.call(selectedOpts.onSuccess,d),modalObject._temp.html(a),processInline()}}}));break;case"image":netbuzz=!1,imgLoader=new Image,imgLoader.onerror=function(){errorjata()},imgLoader.onload=function(){netbuzz=!0,imgLoader.onerror=imgLoader.onload=null,startImageModal()},imgLoader.src=selectedOpts.href;break;case"theatre":netLoading(),netbuzz=!1,startImageModal(selectedOpts.Td);break;case"tabPreview":return netbuzz=!1,tabPreview(selectedOpts.d)}}function processResponseContent(a){var b=JSON.parse(a);return b}function processInline(){var a=selectedOpts.width,b=selectedOpts.height;a=a.toString().indexOf("%")>-1?parseInt(($window.width()-2*selectedOpts.margin)*parseFloat(a)/100,10)+"px":"auto"==a?"auto":a+"px",b=b.toString().indexOf("%")>-1?parseInt((_(window).height()-2*selectedOpts.margin)*parseFloat(b)/100,10)+"px":"auto"==b?"auto":b+"px",modalObject._temp.wrapInner('<div style="width:'+a+";height:"+b+";overflow: "+("auto"==selectedOpts.scrolling?"auto":"yes"==selectedOpts.scrolling?"scroll":"hidden")+';position:relative;"></div>'),selectedOpts.width=modalObject._temp.width(),selectedOpts.height=modalObject._temp.height(),showjata(),$broadcast("modal.is.visible",{})}function showjata(){var a,b;return modalObject.loading.hide(),_(modalObject.content.add(modalObject.overlay)).unbind(),$window.unbind("resize.pj scroll.pj"),$document.unbind("keydown.pj"),selectedOpts.showOverlay&&(modalObject.overlay.css({background:selectedOpts.overlayColor?selectedOpts.overlayColor:"#818181",height:$document.height(),cursor:selectedOpts.hideOverlayclick?"pointer":"auto"}),modalObject.overlay.is(":visible")?modalObject.overlay.hide():modalObject.overlay.show()),main_pos=zoomjata(),modalObject.wrap.is(":visible")?(a=modalObject.wrap.position(),d_pos={top:a.top,left:a.left,width:modalObject.wrap.width(),height:modalObject.wrap.height()},b=d_pos.width==main_pos.width&&d_pos.height==main_pos.height,void modalObject.content.fadeTo("fast",.3,function(){var a=function(){modalObject.content.html(modalObject._temp.contents()).fadeTo("fast",1,finishjata(this))};modalObject.content.empty().removeAttr("filter").css({"border-width":selectedOpts.padding,width:main_pos.width-2*selectedOpts.padding,height:selectedOpts.autoDimensions?"auto":main_pos.height-2*selectedOpts.padding}),b&&a()})):(modalObject.wrap.removeAttr("style"),modalObject.content.css("border-width",selectedOpts.padding),modalObject.content.css({width:main_pos.width-2*selectedOpts.padding,height:selectedOpts.autoDimensions?"auto":main_pos.height-2*selectedOpts.padding}).html(modalObject._temp.contents()),modalObject.wrap.css(main_pos).fadeIn("none"==selectedOpts.transitionIn?0:selectedOpts.speedIn,finishjata(this)),void(selectedOpts.onShow&&selectedOpts.onShow.call(selectedOpts.onShow,modalObject.content)))}function navigatejata(){(selectedOpts.enableEscapebutton||selectedOpts.enableNav)&&$document.bind("keydown.pj",function(a){27==a.keyCode&&selectedOpts.enableEscapebutton?(a.preventDefault(),selectedOpts.theatre?j():k()):37!=a.keyCode&&39!=a.keyCode||!selectedOpts.enableNav||"INPUT"===a.target.tagName||"TEXTAREA"===a.target.tagName||"SELECT"===a.target.tagName||(a.preventDefault(),navigate[37==a.keycode?"Prev":"Next"]())})}function tabPreview(a){var b=_(a);return apos=b.position(),isActive=b.data(".activeTab"),this.destroy=function(){modalObject.tabPreview&&($window.unbind(".tab"),_(a).unbind(".tab"),$document.unbind(".tab"),modalObject.tabPreview.remove(),modalObject.tabPreview=null,b.removeData(".activeTab"),$broadcast("tab.preview.is.destroy"))},this.open=function(c){if(isActive)return void this.destroy();b.data(".activeTab","true");var d=_("<j-tab-preview/>"),e=apos.left<5?Math.round(b.width()-apos.left):Math.round(apos.left-420),f=Math.round(apos.top-15),g=this,h={arrow:tabArrowPoints(a),$destroy:g.destroy};switch(c.type){case"html":h.content=c.content;break;case"load":h.url=$getHref(a);break;case"grab":h.content=_(c.content).html()}var i=null,g=this;b.after(d.appendTo("body").compile(h)),jEli.dom(d.getFirstChild()).css({top:f+"px",left:e+"px"}),d.show(1,function(){$broadcast("tab.preview.open",[b,g])}).bind("mousemove.tab",function(){i=!0}).bind("mouseout.tab",function(){i=!1}).bind("mouseout.tab",function(){i=!1}),$window.bind("scroll.tab",function(){_(d.is(":visible"))&&(i=!0)}),$document.bind("mouseup.tab",function(a){i||g.destroy()}),modalObject.tabPreview=d,$on("tab.preview.destroy",function(){g.destroy()})},this}function $get(a){var b=null;if(null!=a.href||"undefined"!=a.href||""!=a.href)var c=null,b=$http({type:"GET",url:a.href,cache:!1,dataType:a.dtype,data:a.data==c?c:a.data});return b}function $getTitle(a){return a.getAttribute("title")||a.getAttribute("push-title")}function $getHref(a,b){var b=["href","ajaxify","datasrc"];return"#"!=a.getAttribute(b[0])?a.getAttribute(b[1])?a.getAttribute(b[1]):a.getAttribute(b[0]):a.getAttribute(b[1])?a.getAttribute(b[1]):a.getAttribute(b[2])}function $post(a){if(null!=a.href||"undefined"!=a.href)var b=$http({type:"POST",url:a.href,cache:!1,dataType:a.dtype,data:a.data});return b}function tabArrowPoints(a){var b=(_(a),_(a).position());return b.left<5?"left":"right"}function finishjata(a){selectedOpts.autoDimensions&&modalObject.content.css("height","auto"),modalObject.wrap.css("height","auto"),selectedOpts.title&&(modalObject.titleBar.append(selectedOpts.title),modalObject.content.prepend(modalObject.title)),selectedOpts.buttons&&createButtons(selectedOpts.buttons),selectedOpts.centerOnScroll&&$window.bind("scroll.fb",_.fancybox.center),navigatejata(),selectedOpts.theatre||modalObject.wrap.show(),selectedOpts.theatre&&modalObject.wrap.is(":hidden")&&a(),selectedOpts.hideOnOverlayclick&&modalObject.overlay.bind("click",function(){close()}),$window.bind("resize.pj",function(){projataResize()}),busy=!1,centerProjata(),modalObject.content.compile()}function updateImageList(){_("."+classNames.replace(/^\,/,"._&"),modalObject.container).each(function(){$getHref(this)&&d(this)})}function getPageScroll(){var a=0,b=0;return self.pageYOffset?(a=self.pageXOffset,b=self.pageYOffset):$document[0].documentElement&&$document[0].documentElement.scrollTop?(a=$document[0].documentElement.scrollLeft,b=$document[0].documentElement.scrollTop):$document.body&&(a=$document[0].body.scrollLeft,b=$document[0].body.scrollTop),{x:a,y:b}}function getPageSize(){var a,b;return self.innerHeight?(a=self.innerWidth,b=self.innerHeight):$document[0].documentElement&&$document[0].documentElement.clientHeight?(a=$document[0].documentElement.clientWidth,b=$document[0].documentElement.clientHeight):$document[0].body&&(a=$document[0].body.clientWidth,b=$document[0].body.clientHeight),{winWidth:a,winHeight:b}}function docWH(){var a=$document[0].body,b=$document[0].documentElement,c=0,d=0;return b&&(c=Math.max(c,b.scrollWidth,b.offsetWidth),d=Math.max(d,b.scrollHeight,b.offsetHeight)),a&&(c=Math.max(c,a.scrollWidth,a.offsetWidth),d=Math.max(d,a.scrollHeight,a.offsetHeight),$window[0].innerWidth&&(c=Math.max(c,$window[0].innerWidth),d=Math.max(d,$window[0].innerHeight))),[c,d]}function getRequireDetails(a){a=_(a);var b=a.data("src");return b?b:0}function getID(a){return selectedOpts.prefix+a}function hideBadObjects(){for(var a=badObjects,b=0;b<a.length;b++)_(a[b]).css({visibility:"hidden"})}function getAutoHeight(a,b,c){c=c||40;var d=500;return b-(d+a)>c?Math.round(b-a-c):d+a+c>b?Math.round(b-(a+c)):d}function reformatContainer(){var a=(modalObject.Timg.height(),getPageSize()),b=(modalObject.Tbody.width(),modalObject.TBottomC.height()),c=getAutoHeight(b,a.winHeight,40);a.winHeight-b;c>a.winHeight-b&&(c=parseInt(a.winHeight-b-20)),Tpos.height=c,Tpos.top=parseInt((a.winHeight-c-b)/2),Tpos.width=a.winWidth-40,Tpos.left=parseInt((a.winWidth-Tpos.width)/2),Talign=parseInt(Tpos.width-modalObject.Tcomment.width()),modalObject.Timg.css({width:Talign-10,height:Tpos.height}),modalObject.Tcomment.css({"margin-left":parseInt(Talign,10),height:Tpos.height}),modalObject.Thover.css("width",modalObject.Timg.width()),modalObject.TImageData.css({width:modalObject.Timg.width(),top:parseInt(c-50)+"px"}),modalObject.TBottomC.css("width",a.winWidth),modalObject.TCBoard.css({height:parseInt(c-modalObject.TCDetails.height()-75)+"px"}),modalObject.Tbody.css(Tpos)}function startImageModal(a){hideBadObjects(),hideLoading(),reformatContainer(),modalObject.TBottomC.show(),a=_(a),modalObject.TLightImage.hide().attr({src:""}),selectedOpts.startZoom?(modalObject.TCimg.css({width:a.width()+"px",height:a.height()+"px"}),!document.all):(modalObject.Twrap.css({opacity:0}).show().fadeTo(1e3*overlayDuration,selectedOpts.overlayOpacity),modalObject.Tbody.css({left:0,width:"100%"})),modalObject.Tbody.show(),modalObject.Twrap.show(),_("body").css("overflow","hidden"),imageArray=[],groupName=null,startImage=0,_("[aria-theatre="+a.attr("aria-theatre")+"]",modalObject.container).each(function(){$getHref(this)&&(imageArray.push({link:$getHref(this),title:$getTitle(this),details:getRequireDetails(this)}),this==a.get(0)&&(startImage=imageArray.length-1))}),imageArray.length>1&&(groupName=a.attr("class")),selectedOpts.featBrowser&&$window.resize(adjustImageSizeNoEffect),selectedOpts.floating,$window.resize(adjustOverlay),$window.scroll(adjustOverlay),changeImage(startImage),$broadcast("theatre.started",imageArray)}function changeImage(a){activeImage=a,disableKeyBoardNav(),selectedOpts.startZoom||modalObject.TLightImage.hide(),modalObject.TImageData.hide(),modalObject.Thover.hide(),modalObject.TCWriteBoard.hide(),modalObject.TCBoard.html("").hide(),modalObject.TMenu.html(""),imgPreloader=new Image,imgPreloader.onload=function(){imageArray[activeImage].link=imgPreloader.src,imageArray[activeImage].width=imgPreloader.width,imageArray[activeImage].height=imgPreloader.height,adjustImageSize(!1)},selectedOpts.startZoom&&!modalObject.TLightImage.attr("src")&&(imageArray[activeImage].width=320,imageArray[activeImage].height=240,adjustImageSize(!1,!0)),imgPreloader.src=String(imageArray[activeImage].link.split("=")[2]),selectedOpts.googleAnalytics&&urchinTracker(imageArray[activeImage].link)}function adjustImageSize(recall,noImage){var imgWidth=imageArray[activeImage].width,imgHeight=imageArray[activeImage].height,arrayTimg={};arrayTimg.width=modalObject.Timg.width(),arrayTimg.height=modalObject.Timg.height();var imageProportion=imgWidth/imgHeight,_max_size=482,_min_size=200,_nH,_nW;if(imgHeight>imgWidth?(_nH=_max_size,_nW=Math.ceil(imageProportion*_max_size)):(_nW=_max_size,_nH=Math.ceil(imgHeight/imgWidth*_max_size)),selectedOpts.featBrowser){var winProportion=arrayTimg.width/arrayTimg.height,maxHeight=_nH,maxWidth=_nW;(_max_size>arrayTimg.width||_max_size>arrayTimg.height)&&(_nW=_min_size,_nH=Math.ceil(imageProportion*_min_size))}var imgTop=getPageScroll().y+(getPageSize().winHeight-(_nH+modalObject.TBottomC))/2,imageContainer=modalObject.TCimg;if(1==recall)imageContainer.css({height:imgHeight+"px",width:imgWidth+"px"}),selectedOpts.floating?moveEffect(Tbody,imgTop):modalObject.Timg.css({top:imgTop+"px"});else{var LImage=modalObject.TLightImage;imageContainer.stop(!0,!1),LImage.stop(!0,!1);var LImage2;with(selectedOpts.startZoom&&LImage.attr("src")?(LImage2=LImage,LImage2.attr({id:getID("LImage2")})):_("#projata-TBoxImage").remove(),noImage||(LImage=_(imgPreloader),LImage.hide(),LImage.attr({id:getID("projata-TBoxImage")}),imageContainer.append(LImage)),imageContainer)var resizeFactor=imageProportion/(width()/height());if(!noImage){if(selectedOpts.startZoom){LImage2&&_("LImage2").stop(!0,!0);var zoomF=LImage2?120:100;if(LImage2)with(LImage2)css({width:1>resizeFactor?"auto":width()/parent().width()*100+"%",height:1>resizeFactor?height()/parent().height()*100+"%":"auto",left:0,top:0});LImage.css({display:"block",position:"absolute",width:_nW,height:_nH,left:parseInt((modalObject.Timg.width()-_nW)/2),top:parseInt((modalObject.Timg.height()-_nH)/2)+"px"})}selectedOpts.startZoom&&modalObject.loading.hide()}resizeImageContainer(imgTop,_nW,_nH,resizeFactor,noImage)}}function resizeImageContainer(a,b,c,d,e){var f=modalObject.TCimg,g=modalObject.TLightImage;if(!e)var h=_("LImage2");selectedOpts.startZoom&&(g.fadeTo(1e3*resizeDuration,1),document.all||modalObject.TCimg.fadeTo(1e3*resizeDuration,1)),selectedOpts.startZoom&&!e&&h.animate(_.extend({opacity:0},d<1?{height:"120%",top:"0",left:"0%"}:{width:"120%",left:"-10%",top:(100-120*d)/2+"%"}),{queue:!1,duration:1e3*resizeDuration,complete:function(){_(this).remove()}}),f.animate({width:b+"px",height:c+"px"},{queue:!1,duration:1e3*resizeDuration,complete:e?null:function(){showImage()}})}function moveEffect(a,b){modalObject.lightbox.stop(!0,!1),modalObject.lightbox.animate({left:parseInt((getPageSize().winWidth-Tpos.width)/2)},{queue:!1,duration:1e3*resizeDuration,complete:function(){reformatContainer()}})}function showImage(){modalObject.loading.hide(),selectedOpts.startZoom?updateDetails():modalObject.TLightImage.css({opacity:0}).show().fadeTo(500,1,function(){updateDetails()}),preloadNeighborImages()}function updateDetails(){var maxImage=1;if(imageArray.length>1){var num_display=selectedOpts.strings.numDisplayPrefix+" "+eval(activeImage+1)+" "+selectedOpts.strings.numDisplaySeparator+" "+imageArray.length;selectedOpts.showGroupName&&groupName&&(num_display+=" "+selectedOpts.strings.numDisplaySeparator+" "+groupName),modalObject.TImageData.show(),modalObject.TNumDisplay.show(),modalObject.TNumDisplay.html(imageArray[activeImage].title||""),modalObject.TDetailsNav.html(num_display).show(),maxImage=imageArray.length}$broadcast("imageLoaded",{currentImage:imageArray[activeImage],totalImage:maxImage,status:"Success"}),modalObject.Timg.animate({height:"show",opacity:"show"},650,null,function(){updateNav()})}function getReport(a){var b=a.getAttribute("data");return _(b)}function updateNav(){var a=1/imageArray.length;descriptionHeight=descriptionHeight*(1-a)+modalObject.Timg.height()*a,imageArray.length>1&&modalObject.Thover.show(),enableKeyboardNav()}function showNext(){if(imageArray.length>1){if(!selectedOpts.loop&&(activeImage==imageArray.length-1&&0==startImage||activeImage+1==startImage))return void i();changeImageWithData(activeImage==imageArray.length-1?0:activeImage+1)}}function changeImageWithData(a){modalObject.TCimg.animate({height:"hide",opacity:"hide"},650,null,function(){changeImage(a)})}function showPrevious(){imageArray.length>1&&changeImageWithData(0==activeImage?imageArray.length-1:activeImage-1)}function showFirst(){imageArray.length>1&&changeImageWithData(0)}function showLast(){imageArray.length>1&&changeImageWithData(imageArray.length-1)}function enableKeyboardNav(){$document.on("keydown",keyboardAction)}function disableKeyBoardNav(){$document.on("keydown","")}function keyboardAction(a){null==a?keycode=event.keyCode:keycode=a.which;var b=String.fromCharCode(keycode).toLowerCase();"c"==b&&"INPUT"!==a.target.tagName&&"TEXTAREA"!==a.target.tagName&&"SELECT"!==a.target.tagName?end():"%"==b&&"INPUT"!==a.target.tagName&&"TEXTAREA"!==a.target.tagName&&"SELECT"!==a.target.tagName?showPrevious():"'"==b&&"INPUT"!==a.target.tagName&&"TEXTAREA"!==a.target.tagName&&"SELECT"!==a.target.tagName?showNext():"f"==b&&"INPUT"!==a.target.tagName&&"TEXTAREA"!==a.target.tagName&&"SELECT"!==a.target.tagName?showFirst():"l"==b&&"INPUT"!==a.target.tagName&&"TEXTAREA"!==a.target.tagName&&"SELECT"!==a.target.tagName&&showLast()}function preloadNeighborImages(){var a=imageArray.length-1==activeImage?0:activeImage+1;(new Image).src=imageArray[a].link.split("=")[2];var b=0==activeImage?imageArray.length-1:activeImage-1;(new Image).src=imageArray[b].link.split("=")[2]}function end(a){if(a){var b=_(a.target).attr("id");if(getID("projata-theatre-close")!=b&&getID("projata-Tbody")!=b&&getID("projata-theatre")!=b)return}modalObject.TCimg.stop(!0,!1),modalObject.TLightImage.stop(!0,!1),imgPreloader.onload=null,disableKeyBoardNav(),modalObject.Tbody.hide(),modalObject.TBottomC.hide(),selectedOpts.overlayOpacity?modalObject.Twrap.fadeOut(1e3*overlayDuration):modalObject.Twrap.hide(),$window.unbind("resize",adjustImageSizeNoEffect),$window.unbind("scroll",adjustImageSizeNoEffect),$window.unbind("resize",adjustOverlay),$window.unbind("scroll",adjustOverlay),showBadObjects(),_("body").css("overflow","auto"),$broadcast("theatre.ended")}function adjustImageSizeNoEffect(){adjustImageSize(!0)}function adjustOverlay(){modalObject.Twrap.css({left:getPageScroll().x+"px",top:0,width:"100%",height:getPageSize().winHeight+"px"})}function showBadObjects(){for(var a,b=badObjects,c=0;c<b.length;c++){a=$document[0].getElementsByTagName(b[c]);for(var d=0;d<a.length;d++)_(a[d]).css({visibility:"visible"})}}function createButtons(a){var b=!1,c=_("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),d=_("<div></div>").addClass("ui-dialog-buttonset").appendTo(c);modalObject.wrap.find(".ui-dialog-buttonpane").remove(),"object"==typeof a&&null!==a&&_.each(a,function(){return!(b=!0)}),b&&(_.each(a,function(a,b){var c=_('<button type="button"></button>').attr("text",a).unbind("click").addClass("ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only").click(function(){b(!0)}),e=_("<span></span>").addClass("ui-button-text").html(c.attr("text"));c.append(e),c.appendTo(d)}),c.appendTo(modalObject.content))}function projataResize(){modalObject.overlay.is(":visible")&&modalObject.overlay.css("height",$document.height()),centerProjata(!0)}function centerProjata(){var a,b;netbuzz||(b=arguments[0]===!0?1:0,a=viewjata(),!b&&(modalObject.wrap.width()>a[0]||modalObject.wrap.height()>a[1])||modalObject.wrap.stop().animate({top:parseInt(Math.max(a[3]-20,a[3]+.5*(a[1]-modalObject.content.height()-40)-selectedOpts.padding)),left:parseInt(Math.max(a[2]-20,a[2]+.5*(a[0]-modalObject.content.width()-40)-selectedOpts.padding))},"number"==typeof arguments[0]?arguments[0]:200))}function viewjata(){return[$window.width()-2*selectedOpts.margin,$window.height()-2*selectedOpts.margin,$document.scrollLeft()+selectedOpts.margin,$document.scrollTop()+selectedOpts.margin]}function zoomjata(){var a,b=viewjata(),c={},d=selectedOpts.autoScale,e=2*selectedOpts.padding;return selectedOpts.width.toString().indexOf("%")>-1?c.width=parseInt(b[0]*parseFloat(selectedOpts.width)/100,10):c.width=selectedOpts.width+e,selectedOpts.height.toString().indexOf("%")>-1?c.height=parseInt(b[1]*parseFloat(selectedOpts.height)/100,10):c.height=selectedOpts.height+e,d&&(c.width>b[0]||c.height>b[1])&&("image"==selectedOpts.type||"swf"==selectedOpts.type?(a=selectedOpts.width/selectedOpts.height,c.width>b[0]&&(c.width=b[0],c.height=parseInt((c.width-e)/a+e,10)),c.height>b[1]&&(c.height=b[1],c.width=parseInt((c.height-e)*a+e,10))):(c.width=Math.min(c.width,b[0]),c.height=Math.min(c.height,b[1]))),c.top=parseInt(Math.max(b[3]-20,b[3]+.5*(b[1]-c.height-40)),10),c.left=parseInt(Math.max(b[2]-20,b[2]+.5*(b[0]-c.width-40)),10),c}function netLoading(){modalObject.loading.is(":visible")||(_("div",modalObject.loading).html(netLoad),modalObject.loading.show())}function hideLoading(){modalObject.loading.is(":visible")&&modalObject.loading.hide()}function cancel(){netbuzz||(netbuzz=!0,abortjata(),netbuzz=!1)}function closeJata(a){function b(){modalObject.overlay.fadeOut(),modalObject.wrap.hide(),modalObject.content.empty(),modalObject.titleBar.empty().append(modalObject.close),selectedOpts.onClosed(selectedArray,selectedIndex,selectedOpts),netbuzz=!1}netbuzz||modalObject.wrap.is(":hidden")||(netbuzz=!0,abortjata(),$window.unbind("resize.pj scroll.pj"),$document.unbind("keydown.pj"),modalObject.wrap.stop(),modalObject.wrap.fadeOut(a?a:300,b),$broadcast("cleanup"),$broadcast("modal.is.destroyed"))}function $alert(a){modalIntializer({modal:1,content:a.content,title:a.title,buttons:{Close:jEli.$isUndefined(a.callback)?closeJata:a.callback}}),a.timeOut&&setTimeout(a.callback||closeJata,a.timeOut)}function confirm(a){modalIntializer({content:a.content,title:a.title,modal:1,buttons:{Ok:a.callback,Cancel:function(){closeJata()}}})}function $prompt(a){modalIntializer(a)}var modalObject={},imgPreloader,netLoad="<img src=/exc-Loading.gif>",Tpos={},descriptionHeight=70,main_pos,d_pos,classNames,imgRegExp=/\.(jpg|gif|png|bmp|jpeg)(.*)?_/i,badObjects=["select","object","embed"],imgLoader,imageArray=[],groupName=null,classNames,resizeDuration,overlayDuration,container,startImage=null,activeImage=null,container,loadingTimer,selectedOpts={},selectedArray=[],selectedIndex=0,currentArray=[],currentIndex=0,currentOpts={},ajaxLoader=null,netbuzz=!1,_events={};return{modalObjects:modalObject,modal:modalIntializer,tabPreview:tabPreview,startImagejata:startImageModal,theatre:{showNext:showNext,showPrev:showPrevious,showFirst:showFirst,showLast:showLast,closeTheatre:end},loader:{show:netLoading,hide:hideLoading},$closejata:closeJata,$alert:$alert,$confirm:confirm,$prompt:$prompt,reformatContainer:reformatContainer,$on:$on,$broadcast:$broadcast}}var moduleName="jEli.Modal",module;try{module=jEli.jModule(moduleName)}catch(a){jEli.jModule(moduleName,[])}module.jFactory("modalFactory",["$document","$window","$http",bnModalFactoryFN]).jElement("jLoading",["modalFactory","$document",jLoadingDirectiveFn]).jElement("jModal",["modalFactory","$document",jModalDirectiveFn]).jElement("jTheatre",["modalFactory","$document",jTheatreDirectiveFn]).jElement("jTabPreview",["modalFactory","$document",jTabPreviewDirectiveFn]).jElement("jModalUi",jModalUiFn)}(jEli,jEli.dom);