!function(){"use strict";function a(){var a={};this.setIdleTime=function(b){a.idleTime=b||30},this.setTimeOutWarn=function(b){a.timeOutWarn=b},this.$get=function(){return function(b){return a[b]}}}function b(a,b,c,d){function e(){if(+new Date>=h.expires_at)return l.trigger("isTimedOut"),void s.$destroy(i);if(k>=p&&(j=!1,l.trigger("isIdle")),j&&(l.trigger("isAlive"),q)){var a=h.expires_at-+new Date<=1e3*q;a&&!t&&(l.trigger("isTimeOutWarn"),t=!0)}k++,m++}function f(){function b(){return{type:"",currentTime:null,expiresAt:h.expires_at,expiresIn:h.expires_in,$current:m,isAlive:j,idle:k,canRevalidate:function(a){return!!a&&this.expiresAt-this.currentTime<=1e3*a}}}function c(a){if(a&&n[a]){var c=b();c.type=a,c.currentTime=+new Date,n[a](c)}}var d=function(a){c(a)};this.on=function(a,b){return a&&b&&(n[a]=b),this},this.trigger=function(a){a&&r.indexOf(a)>-1&&o!==a&&(d(a),o=a)};var e=this;a.on("mousedown.watchman keydown.watchman",function(a){k=0,"isIdle"===o&&e.trigger("isIdleEnd"),j=!0,e.trigger("isAlive")})}function g(){var a=!1,d=jEli.dom("body"),e=b.$new(),f=c.get("$jCompiler");this.open=function(b){var c={html:"Set Alert Message here",include:null,title:"Alert Status",isActive:!0};e.modal=jEli.$extend(c,b),e.trigger=function(a){b[a]&&jEli.$isFunction(b[a])&&b[a]()},a||d.append(f("<session-alert></session-alert>")(e)),e.$consume(),a=!0},this.close=function(b){a=!a,jEli.dom("session-alert").remove(),b&&jEli.$isFunction(b)&&b(e)}}var h={},i=null,j=1,k=0,l={},m=0,n={},o=null,p=d("idleTime"),q=d("timeOutWarn"),r=["isIdle","isAlive","isIdleEnd","isTimedOut","isTimeOutWarn"],s=this,t=!1;return this.setWatchObject=function(a){return a&&jEli.$isObject(a)&&(h=a),this},this.startWatch=function(a){return h.expires_at&&h.access_token&&(i=setInterval(e,a||1e3),l=new f),this.started=!0,l},this.$destroy=function(){this.started&&(clearInterval(i),a.unbind(".watchman"),delete this.started)},this.reset=function(){t=!1},this.alert=new g,this}function c(a){return{template:function(){var a='<div class="overlay"></div><div>';return a+='<div class="modal-dialog countDown"><div class="modal-content"><div class="modal-header" j-if="modal.title">',a+='{{modal.title | translate}}</div><div class="modal-body">',a+='<div j-if="modal.html && !modal.include" j-bind-html="modal.html">{{modal.html}}</div>',a+='<div j-if="modal.include"><div j-include="modal.include"></div></div></div></div></div></div>'}}}jEli.jModule("session.management",[]).jProvider("session",a).jFactory("sessionManagement",["$document","$rootModel","$injector","session",b]).jElement("sessionAlert",["$jCompiler",c])}();